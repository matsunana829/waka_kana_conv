# 仮名変換ツール

和歌本文を MeCab + 和歌UniDic で形態素解析し、読みを抽出して仮名変換する Streamlit アプリです。

このリポジトリには **`packages.txt`** を同梱しており、サーバー側にMeCab本体をインストールします。  
また、**和歌UniDicはサーバー側で自動ダウンロード**されるようになっています。   

## アプリ使い方ガイド
1. 入力ファイルがXMLの場合は「XML本文タグ名」に仮名に変換したい本文のタグ名（例: `l` や `seg`）を入れます  
   入力ファイルがCSVの場合は、「CSV本文列名」に仮名に変換したい本文の列名を入れます  
2. 出力形式（txt / csv / xml）を選びます  
3. 画面中央の「入力ファイル」からファイルを選び、「変換する」を押します  

## チェックモードについて
MeCabと和歌UniDicによる仮名変換では誤りが生じる可能性があります。  
その確認をしやすくするため、**和歌各句が `seg` タグで区切られているXML** に対して、  
ひらがな変換後の文字数が **5-7-5-7-7** になっているかを確認するチェック機能を用意しています。  

ただし以下の制約があります。  
- **字余り・字足らずの和歌**も検出対象になるため、必ずしも誤りとは限りません。  
- **誤りがあっても偶然 5-7-5-7-7 になる場合は検出できません。**  
  
このため、**チェックモードは補助的なツール**としてご利用ください。  

### チェックモードの使い方
1. 「和歌XMLチェック」タブを開く  
2. 「もとのXMLデータ」と「かな変換後のXMLデータ」を指定  
   - 変換タブでXMLを処理済みの場合は、自動的に候補として選べます  
3. 行タグ名（例: `l`）と句タグ名（例: `seg`）を指定  
4. 「チェックする」を押す  
5. 不一致がある場合は、その場で修正して修正済みXMLをダウンロードできます  

## 入力形式
- `.txt` / `.docx` / `.csv` / `.xml`

## 出力形式
- `.txt` / `.csv` / `.xml`
- `.docx` 入力時は **txt と docx を両方出力**

## メモ
- CSV/XML は本文フィールドのみ変換し、構造を保持します。
- 未知語は原文を保持します。
- 初回起動時は和歌UniDicの自動ダウンロードが走るため、少し時間がかかる場合があります。
